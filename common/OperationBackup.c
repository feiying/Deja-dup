/* OperationBackup.c generated by valac 0.16.1, the Vala compiler
 * generated from OperationBackup.vala, do not modify */

/* -*- Mode: Vala; indent-tabs-mode: nil; tab-width: 2 -*- */
/*
    This file is part of Déjà Dup.
    For copyright information, see AUTHORS.

    Déjà Dup is free software: you can redistribute it and/or modify
    it under the terms of the GNU General Public License as published by
    the Free Software Foundation, either version 3 of the License, or
    (at your option) any later version.

    Déjà Dup is distributed in the hope that it will be useful,
    but WITHOUT ANY WARRANTY; without even the implied warranty of
    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    GNU General Public License for more details.

    You should have received a copy of the GNU General Public License
    along with Déjà Dup.  If not, see <http://www.gnu.org/licenses/>.
*/

#include <glib.h>
#include <glib-object.h>
#include <gio/gio.h>
#include <stdlib.h>
#include <string.h>
#include <glib/gi18n-lib.h>
#include <stdio.h>
#include <config.h>
#include <glib/gstdio.h>


#define DEJA_DUP_TYPE_OPERATION (deja_dup_operation_get_type ())
#define DEJA_DUP_OPERATION(obj) (G_TYPE_CHECK_INSTANCE_CAST ((obj), DEJA_DUP_TYPE_OPERATION, DejaDupOperation))
#define DEJA_DUP_OPERATION_CLASS(klass) (G_TYPE_CHECK_CLASS_CAST ((klass), DEJA_DUP_TYPE_OPERATION, DejaDupOperationClass))
#define DEJA_DUP_IS_OPERATION(obj) (G_TYPE_CHECK_INSTANCE_TYPE ((obj), DEJA_DUP_TYPE_OPERATION))
#define DEJA_DUP_IS_OPERATION_CLASS(klass) (G_TYPE_CHECK_CLASS_TYPE ((klass), DEJA_DUP_TYPE_OPERATION))
#define DEJA_DUP_OPERATION_GET_CLASS(obj) (G_TYPE_INSTANCE_GET_CLASS ((obj), DEJA_DUP_TYPE_OPERATION, DejaDupOperationClass))

typedef struct _DejaDupOperation DejaDupOperation;
typedef struct _DejaDupOperationClass DejaDupOperationClass;
typedef struct _DejaDupOperationPrivate DejaDupOperationPrivate;

#define DEJA_DUP_TYPE_TOOL_JOB (deja_dup_tool_job_get_type ())
#define DEJA_DUP_TOOL_JOB(obj) (G_TYPE_CHECK_INSTANCE_CAST ((obj), DEJA_DUP_TYPE_TOOL_JOB, DejaDupToolJob))
#define DEJA_DUP_TOOL_JOB_CLASS(klass) (G_TYPE_CHECK_CLASS_CAST ((klass), DEJA_DUP_TYPE_TOOL_JOB, DejaDupToolJobClass))
#define DEJA_DUP_IS_TOOL_JOB(obj) (G_TYPE_CHECK_INSTANCE_TYPE ((obj), DEJA_DUP_TYPE_TOOL_JOB))
#define DEJA_DUP_IS_TOOL_JOB_CLASS(klass) (G_TYPE_CHECK_CLASS_TYPE ((klass), DEJA_DUP_TYPE_TOOL_JOB))
#define DEJA_DUP_TOOL_JOB_GET_CLASS(obj) (G_TYPE_INSTANCE_GET_CLASS ((obj), DEJA_DUP_TYPE_TOOL_JOB, DejaDupToolJobClass))

typedef struct _DejaDupToolJob DejaDupToolJob;
typedef struct _DejaDupToolJobClass DejaDupToolJobClass;

#define DEJA_DUP_TYPE_OPERATION_BACKUP (deja_dup_operation_backup_get_type ())
#define DEJA_DUP_OPERATION_BACKUP(obj) (G_TYPE_CHECK_INSTANCE_CAST ((obj), DEJA_DUP_TYPE_OPERATION_BACKUP, DejaDupOperationBackup))
#define DEJA_DUP_OPERATION_BACKUP_CLASS(klass) (G_TYPE_CHECK_CLASS_CAST ((klass), DEJA_DUP_TYPE_OPERATION_BACKUP, DejaDupOperationBackupClass))
#define DEJA_DUP_IS_OPERATION_BACKUP(obj) (G_TYPE_CHECK_INSTANCE_TYPE ((obj), DEJA_DUP_TYPE_OPERATION_BACKUP))
#define DEJA_DUP_IS_OPERATION_BACKUP_CLASS(klass) (G_TYPE_CHECK_CLASS_TYPE ((klass), DEJA_DUP_TYPE_OPERATION_BACKUP))
#define DEJA_DUP_OPERATION_BACKUP_GET_CLASS(obj) (G_TYPE_INSTANCE_GET_CLASS ((obj), DEJA_DUP_TYPE_OPERATION_BACKUP, DejaDupOperationBackupClass))

typedef struct _DejaDupOperationBackup DejaDupOperationBackup;
typedef struct _DejaDupOperationBackupClass DejaDupOperationBackupClass;
typedef struct _DejaDupOperationBackupPrivate DejaDupOperationBackupPrivate;
#define _g_object_unref0(var) ((var == NULL) ? NULL : (var = (g_object_unref (var), NULL)))

#define DEJA_DUP_TOOL_JOB_TYPE_MODE (deja_dup_tool_job_mode_get_type ())
#define _g_free0(var) (var = (g_free (var), NULL))

#define DEJA_DUP_TYPE_TIMESTAMP_TYPE (deja_dup_timestamp_type_get_type ())

#define DEJA_DUP_TYPE_RECURSIVE_OP (deja_dup_recursive_op_get_type ())
#define DEJA_DUP_RECURSIVE_OP(obj) (G_TYPE_CHECK_INSTANCE_CAST ((obj), DEJA_DUP_TYPE_RECURSIVE_OP, DejaDupRecursiveOp))
#define DEJA_DUP_RECURSIVE_OP_CLASS(klass) (G_TYPE_CHECK_CLASS_CAST ((klass), DEJA_DUP_TYPE_RECURSIVE_OP, DejaDupRecursiveOpClass))
#define DEJA_DUP_IS_RECURSIVE_OP(obj) (G_TYPE_CHECK_INSTANCE_TYPE ((obj), DEJA_DUP_TYPE_RECURSIVE_OP))
#define DEJA_DUP_IS_RECURSIVE_OP_CLASS(klass) (G_TYPE_CHECK_CLASS_TYPE ((klass), DEJA_DUP_TYPE_RECURSIVE_OP))
#define DEJA_DUP_RECURSIVE_OP_GET_CLASS(obj) (G_TYPE_INSTANCE_GET_CLASS ((obj), DEJA_DUP_TYPE_RECURSIVE_OP, DejaDupRecursiveOpClass))

typedef struct _DejaDupRecursiveOp DejaDupRecursiveOp;
typedef struct _DejaDupRecursiveOpClass DejaDupRecursiveOpClass;

#define DEJA_DUP_TYPE_RECURSIVE_DELETE (deja_dup_recursive_delete_get_type ())
#define DEJA_DUP_RECURSIVE_DELETE(obj) (G_TYPE_CHECK_INSTANCE_CAST ((obj), DEJA_DUP_TYPE_RECURSIVE_DELETE, DejaDupRecursiveDelete))
#define DEJA_DUP_RECURSIVE_DELETE_CLASS(klass) (G_TYPE_CHECK_CLASS_CAST ((klass), DEJA_DUP_TYPE_RECURSIVE_DELETE, DejaDupRecursiveDeleteClass))
#define DEJA_DUP_IS_RECURSIVE_DELETE(obj) (G_TYPE_CHECK_INSTANCE_TYPE ((obj), DEJA_DUP_TYPE_RECURSIVE_DELETE))
#define DEJA_DUP_IS_RECURSIVE_DELETE_CLASS(klass) (G_TYPE_CHECK_CLASS_TYPE ((klass), DEJA_DUP_TYPE_RECURSIVE_DELETE))
#define DEJA_DUP_RECURSIVE_DELETE_GET_CLASS(obj) (G_TYPE_INSTANCE_GET_CLASS ((obj), DEJA_DUP_TYPE_RECURSIVE_DELETE, DejaDupRecursiveDeleteClass))

typedef struct _DejaDupRecursiveDelete DejaDupRecursiveDelete;
typedef struct _DejaDupRecursiveDeleteClass DejaDupRecursiveDeleteClass;

#define DEJA_DUP_TYPE_OPERATION_VERIFY (deja_dup_operation_verify_get_type ())
#define DEJA_DUP_OPERATION_VERIFY(obj) (G_TYPE_CHECK_INSTANCE_CAST ((obj), DEJA_DUP_TYPE_OPERATION_VERIFY, DejaDupOperationVerify))
#define DEJA_DUP_OPERATION_VERIFY_CLASS(klass) (G_TYPE_CHECK_CLASS_CAST ((klass), DEJA_DUP_TYPE_OPERATION_VERIFY, DejaDupOperationVerifyClass))
#define DEJA_DUP_IS_OPERATION_VERIFY(obj) (G_TYPE_CHECK_INSTANCE_TYPE ((obj), DEJA_DUP_TYPE_OPERATION_VERIFY))
#define DEJA_DUP_IS_OPERATION_VERIFY_CLASS(klass) (G_TYPE_CHECK_CLASS_TYPE ((klass), DEJA_DUP_TYPE_OPERATION_VERIFY))
#define DEJA_DUP_OPERATION_VERIFY_GET_CLASS(obj) (G_TYPE_INSTANCE_GET_CLASS ((obj), DEJA_DUP_TYPE_OPERATION_VERIFY, DejaDupOperationVerifyClass))

typedef struct _DejaDupOperationVerify DejaDupOperationVerify;
typedef struct _DejaDupOperationVerifyClass DejaDupOperationVerifyClass;
typedef struct _DejaDupOperationBackupOperationFinishedData DejaDupOperationBackupOperationFinishedData;

#define DEJA_DUP_TYPE_SIMPLE_SETTINGS (deja_dup_simple_settings_get_type ())
#define DEJA_DUP_SIMPLE_SETTINGS(obj) (G_TYPE_CHECK_INSTANCE_CAST ((obj), DEJA_DUP_TYPE_SIMPLE_SETTINGS, DejaDupSimpleSettings))
#define DEJA_DUP_SIMPLE_SETTINGS_CLASS(klass) (G_TYPE_CHECK_CLASS_CAST ((klass), DEJA_DUP_TYPE_SIMPLE_SETTINGS, DejaDupSimpleSettingsClass))
#define DEJA_DUP_IS_SIMPLE_SETTINGS(obj) (G_TYPE_CHECK_INSTANCE_TYPE ((obj), DEJA_DUP_TYPE_SIMPLE_SETTINGS))
#define DEJA_DUP_IS_SIMPLE_SETTINGS_CLASS(klass) (G_TYPE_CHECK_CLASS_TYPE ((klass), DEJA_DUP_TYPE_SIMPLE_SETTINGS))
#define DEJA_DUP_SIMPLE_SETTINGS_GET_CLASS(obj) (G_TYPE_INSTANCE_GET_CLASS ((obj), DEJA_DUP_TYPE_SIMPLE_SETTINGS, DejaDupSimpleSettingsClass))

typedef struct _DejaDupSimpleSettings DejaDupSimpleSettings;
typedef struct _DejaDupSimpleSettingsClass DejaDupSimpleSettingsClass;
#define _g_error_free0(var) ((var == NULL) ? NULL : (var = (g_error_free (var), NULL)))
#define _g_variant_unref0(var) ((var == NULL) ? NULL : (var = (g_variant_unref (var), NULL)))
typedef struct _DejaDupToolJobPrivate DejaDupToolJobPrivate;
#define __g_list_free__g_free0_0(var) ((var == NULL) ? NULL : (var = (_g_list_free__g_free0_ (var), NULL)))
#define _g_date_time_unref0(var) ((var == NULL) ? NULL : (var = (g_date_time_unref (var), NULL)))

struct _DejaDupOperation {
	GObject parent_instance;
	DejaDupOperationPrivate * priv;
	DejaDupToolJob* job;
	gchar* passphrase;
};

struct _DejaDupOperationClass {
	GObjectClass parent_class;
	void (*start) (DejaDupOperation* self, gboolean try_claim_bus, GAsyncReadyCallback _callback_, gpointer _user_data_);
	void (*start_finish) (DejaDupOperation* self, GAsyncResult* _res_);
	void (*connect_to_job) (DejaDupOperation* self);
	void (*send_action_file_changed) (DejaDupOperation* self, GFile* file, gboolean actual);
	void (*operation_finished) (DejaDupOperation* self, DejaDupToolJob* job, gboolean success, gboolean cancelled, const gchar* detail, GAsyncReadyCallback _callback_, gpointer _user_data_);
	void (*operation_finished_finish) (DejaDupOperation* self, GAsyncResult* _res_);
	GList* (*make_argv) (DejaDupOperation* self);
};

struct _DejaDupOperationBackup {
	DejaDupOperation parent_instance;
	DejaDupOperationBackupPrivate * priv;
};

struct _DejaDupOperationBackupClass {
	DejaDupOperationClass parent_class;
};

struct _DejaDupOperationBackupPrivate {
	GFile* metadir;
};

typedef enum  {
	DEJA_DUP_TOOL_JOB_MODE_INVALID,
	DEJA_DUP_TOOL_JOB_MODE_BACKUP,
	DEJA_DUP_TOOL_JOB_MODE_RESTORE,
	DEJA_DUP_TOOL_JOB_MODE_STATUS,
	DEJA_DUP_TOOL_JOB_MODE_LIST,
	DEJA_DUP_TOOL_JOB_MODE_HISTORY
} DejaDupToolJobMode;

typedef enum  {
	DEJA_DUP_TIMESTAMP_TYPE_NONE,
	DEJA_DUP_TIMESTAMP_TYPE_BACKUP,
	DEJA_DUP_TIMESTAMP_TYPE_RESTORE
} DejaDupTimestampType;

struct _DejaDupOperationBackupOperationFinishedData {
	int _state_;
	GObject* _source_object_;
	GAsyncResult* _res_;
	GSimpleAsyncResult* _async_result;
	DejaDupOperationBackup* self;
	DejaDupToolJob* job;
	gboolean success;
	gboolean cancelled;
	gchar* detail;
	gboolean _tmp0_;
	GFile* _tmp1_;
	GFile* _tmp2_;
	DejaDupRecursiveDelete* _tmp3_;
	DejaDupRecursiveDelete* _tmp4_;
	gboolean _tmp5_;
	gboolean _tmp6_;
	gboolean _tmp7_;
	gboolean _tmp8_;
	DejaDupOperationVerify* _tmp9_;
	DejaDupOperationVerify* _tmp10_;
	const gchar* _tmp11_;
	const gchar* _tmp12_;
	DejaDupToolJob* _tmp13_;
	gboolean _tmp14_;
	gboolean _tmp15_;
	const gchar* _tmp16_;
};

struct _DejaDupToolJob {
	GObject parent_instance;
	DejaDupToolJobPrivate * priv;
	GList* includes;
	GList* excludes;
	GList* _restore_files;
};

struct _DejaDupToolJobClass {
	GObjectClass parent_class;
	void (*start) (DejaDupToolJob* self);
	void (*cancel) (DejaDupToolJob* self);
	void (*stop) (DejaDupToolJob* self);
	void (*pause) (DejaDupToolJob* self, const gchar* reason);
	void (*resume) (DejaDupToolJob* self);
};


static gpointer deja_dup_operation_backup_parent_class = NULL;

GType deja_dup_operation_get_type (void) G_GNUC_CONST;
GType deja_dup_tool_job_get_type (void) G_GNUC_CONST;
GType deja_dup_operation_backup_get_type (void) G_GNUC_CONST;
#define DEJA_DUP_OPERATION_BACKUP_GET_PRIVATE(o) (G_TYPE_INSTANCE_GET_PRIVATE ((o), DEJA_DUP_TYPE_OPERATION_BACKUP, DejaDupOperationBackupPrivate))
enum  {
	DEJA_DUP_OPERATION_BACKUP_DUMMY_PROPERTY
};
DejaDupOperationBackup* deja_dup_operation_backup_new (void);
DejaDupOperationBackup* deja_dup_operation_backup_construct (GType object_type);
GType deja_dup_tool_job_mode_get_type (void) G_GNUC_CONST;
static void deja_dup_operation_backup_real_operation_finished_data_free (gpointer _data);
static void deja_dup_operation_backup_real_operation_finished (DejaDupOperation* base, DejaDupToolJob* job, gboolean success, gboolean cancelled, const gchar* detail, GAsyncReadyCallback _callback_, gpointer _user_data_);
static gboolean deja_dup_operation_backup_real_operation_finished_co (DejaDupOperationBackupOperationFinishedData* _data_);
GType deja_dup_timestamp_type_get_type (void) G_GNUC_CONST;
void deja_dup_update_last_run_timestamp (DejaDupTimestampType type);
DejaDupRecursiveDelete* deja_dup_recursive_delete_new (GFile* source);
DejaDupRecursiveDelete* deja_dup_recursive_delete_construct (GType object_type, GFile* source);
GType deja_dup_recursive_op_get_type (void) G_GNUC_CONST;
GType deja_dup_recursive_delete_get_type (void) G_GNUC_CONST;
void deja_dup_recursive_op_start (DejaDupRecursiveOp* self);
void deja_dup_operation_chain_op (DejaDupOperation* self, DejaDupOperation* subop, const gchar* desc, const gchar* detail, GAsyncReadyCallback _callback_, gpointer _user_data_);
void deja_dup_operation_chain_op_finish (DejaDupOperation* self, GAsyncResult* _res_);
DejaDupOperationVerify* deja_dup_operation_verify_new (void);
DejaDupOperationVerify* deja_dup_operation_verify_construct (GType object_type);
GType deja_dup_operation_verify_get_type (void) G_GNUC_CONST;
static void deja_dup_operation_backup_operation_finished_ready (GObject* source_object, GAsyncResult* _res_, gpointer _user_data_);
void deja_dup_operation_operation_finished (DejaDupOperation* self, DejaDupToolJob* job, gboolean success, gboolean cancelled, const gchar* detail, GAsyncReadyCallback _callback_, gpointer _user_data_);
void deja_dup_operation_operation_finished_finish (DejaDupOperation* self, GAsyncResult* _res_);
static void deja_dup_operation_backup_real_send_action_file_changed (DejaDupOperation* base, GFile* file, gboolean actual);
void deja_dup_operation_send_action_file_changed (DejaDupOperation* self, GFile* file, gboolean actual);
void deja_dup_operation_backup_save_gsettings (DejaDupOperationBackup* self, const gchar* schema);
GType deja_dup_simple_settings_get_type (void) G_GNUC_CONST;
DejaDupSimpleSettings* deja_dup_get_app_settings (const gchar* ske, const gchar* subdir);
static gchar* _variant_get1 (GVariant* value);
static GList* deja_dup_operation_backup_real_make_argv (DejaDupOperation* base);
DejaDupSimpleSettings* deja_dup_get_settings (const gchar* subdir);
#define DEJA_DUP_INCLUDE_LIST_KEY "include-list"
GFile** deja_dup_parse_dir_list (const gchar** dirs, int dirs_length1, int* result_length1);
#define DEJA_DUP_EXCLUDE_LIST_KEY "exclude-list"
#define DEJA_DUP_APPS_ROOT "Apps"
#define DEJA_DUP_APPS_LIST_KEY "apps-list"
static GList* deja_dup_operation_backup_get_always_excluded_dirs (DejaDupOperationBackup* self);
static void _g_free0_ (gpointer var);
static void _g_list_free__g_free0_ (GList* self);
#define DEJA_DUP_BACKUP_KEY "backup"
static void deja_dup_operation_backup_fill_metadir (DejaDupOperationBackup* self, GError** error);
void deja_dup_tool_job_set_local (DejaDupToolJob* self, GFile* value);
static void deja_dup_operation_backup_finalize (GObject* obj);
static void _vala_array_destroy (gpointer array, gint array_length, GDestroyNotify destroy_func);
static void _vala_array_free (gpointer array, gint array_length, GDestroyNotify destroy_func);
static gint _vala_array_length (gpointer array);


DejaDupOperationBackup* deja_dup_operation_backup_construct (GType object_type) {
	DejaDupOperationBackup * self = NULL;
	self = (DejaDupOperationBackup*) g_object_new (object_type, "mode", DEJA_DUP_TOOL_JOB_MODE_BACKUP, NULL);
	return self;
}


DejaDupOperationBackup* deja_dup_operation_backup_new (void) {
	return deja_dup_operation_backup_construct (DEJA_DUP_TYPE_OPERATION_BACKUP);
}


static void deja_dup_operation_backup_real_operation_finished_data_free (gpointer _data) {
	DejaDupOperationBackupOperationFinishedData* _data_;
	_data_ = _data;
	_g_object_unref0 (_data_->job);
	_g_free0 (_data_->detail);
	_g_object_unref0 (_data_->self);
	g_slice_free (DejaDupOperationBackupOperationFinishedData, _data_);
}


static gpointer _g_object_ref0 (gpointer self) {
	return self ? g_object_ref (self) : NULL;
}


static void deja_dup_operation_backup_real_operation_finished (DejaDupOperation* base, DejaDupToolJob* job, gboolean success, gboolean cancelled, const gchar* detail, GAsyncReadyCallback _callback_, gpointer _user_data_) {
	DejaDupOperationBackup * self;
	DejaDupOperationBackupOperationFinishedData* _data_;
	DejaDupOperationBackup* _tmp0_;
	DejaDupToolJob* _tmp1_;
	DejaDupToolJob* _tmp2_;
	gboolean _tmp3_;
	gboolean _tmp4_;
	const gchar* _tmp5_;
	gchar* _tmp6_;
	self = (DejaDupOperationBackup*) base;
	_data_ = g_slice_new0 (DejaDupOperationBackupOperationFinishedData);
	_data_->_async_result = g_simple_async_result_new (G_OBJECT (self), _callback_, _user_data_, deja_dup_operation_backup_real_operation_finished);
	g_simple_async_result_set_op_res_gpointer (_data_->_async_result, _data_, deja_dup_operation_backup_real_operation_finished_data_free);
	_tmp0_ = _g_object_ref0 (self);
	_data_->self = _tmp0_;
	_tmp1_ = job;
	_tmp2_ = _g_object_ref0 (_tmp1_);
	_data_->job = _tmp2_;
	_tmp3_ = success;
	_data_->success = _tmp3_;
	_tmp4_ = cancelled;
	_data_->cancelled = _tmp4_;
	_tmp5_ = detail;
	_tmp6_ = g_strdup (_tmp5_);
	_data_->detail = _tmp6_;
	deja_dup_operation_backup_real_operation_finished_co (_data_);
}


static void deja_dup_operation_backup_real_operation_finished_finish (DejaDupOperation* base, GAsyncResult* _res_) {
	DejaDupOperationBackupOperationFinishedData* _data_;
	_data_ = g_simple_async_result_get_op_res_gpointer (G_SIMPLE_ASYNC_RESULT (_res_));
}


static void deja_dup_operation_backup_operation_finished_ready (GObject* source_object, GAsyncResult* _res_, gpointer _user_data_) {
	DejaDupOperationBackupOperationFinishedData* _data_;
	_data_ = _user_data_;
	_data_->_source_object_ = source_object;
	_data_->_res_ = _res_;
	deja_dup_operation_backup_real_operation_finished_co (_data_);
}


static gboolean deja_dup_operation_backup_real_operation_finished_co (DejaDupOperationBackupOperationFinishedData* _data_) {
	switch (_data_->_state_) {
		case 0:
		goto _state_0;
		case 1:
		goto _state_1;
		case 2:
		goto _state_2;
		default:
		g_assert_not_reached ();
	}
	_state_0:
	_data_->_tmp0_ = _data_->success;
	if (_data_->_tmp0_) {
		deja_dup_update_last_run_timestamp (DEJA_DUP_TIMESTAMP_TYPE_BACKUP);
	}
	_data_->_tmp1_ = _data_->self->priv->metadir;
	if (_data_->_tmp1_ != NULL) {
		_data_->_tmp2_ = _data_->self->priv->metadir;
		_data_->_tmp3_ = deja_dup_recursive_delete_new (_data_->_tmp2_);
		_data_->_tmp4_ = _data_->_tmp3_;
		deja_dup_recursive_op_start ((DejaDupRecursiveOp*) _data_->_tmp4_);
		_g_object_unref0 (_data_->_tmp4_);
	}
	_data_->_tmp6_ = _data_->success;
	if (_data_->_tmp6_) {
		_data_->_tmp7_ = _data_->cancelled;
		_data_->_tmp5_ = !_data_->_tmp7_;
	} else {
		_data_->_tmp5_ = FALSE;
	}
	_data_->_tmp8_ = _data_->_tmp5_;
	if (_data_->_tmp8_) {
		_data_->_tmp9_ = deja_dup_operation_verify_new ();
		_data_->_tmp10_ = _data_->_tmp9_;
		_data_->_tmp11_ = NULL;
		_data_->_tmp11_ = _ ("Verifying backup…");
		_data_->_tmp12_ = _data_->detail;
		_data_->_state_ = 1;
		deja_dup_operation_chain_op ((DejaDupOperation*) _data_->self, (DejaDupOperation*) _data_->_tmp10_, _data_->_tmp11_, _data_->_tmp12_, deja_dup_operation_backup_operation_finished_ready, _data_);
		return FALSE;
		_state_1:
		deja_dup_operation_chain_op_finish ((DejaDupOperation*) _data_->self, _data_->_res_);
		_g_object_unref0 (_data_->_tmp10_);
	} else {
		_data_->_tmp13_ = _data_->job;
		_data_->_tmp14_ = _data_->success;
		_data_->_tmp15_ = _data_->cancelled;
		_data_->_tmp16_ = _data_->detail;
		_data_->_state_ = 2;
		DEJA_DUP_OPERATION_CLASS (deja_dup_operation_backup_parent_class)->operation_finished (DEJA_DUP_OPERATION (_data_->self), _data_->_tmp13_, _data_->_tmp14_, _data_->_tmp15_, _data_->_tmp16_, deja_dup_operation_backup_operation_finished_ready, _data_);
		return FALSE;
		_state_2:
		DEJA_DUP_OPERATION_CLASS (deja_dup_operation_backup_parent_class)->operation_finished_finish (DEJA_DUP_OPERATION (_data_->self), _data_->_res_);
	}
	if (_data_->_state_ == 0) {
		g_simple_async_result_complete_in_idle (_data_->_async_result);
	} else {
		g_simple_async_result_complete (_data_->_async_result);
	}
	g_object_unref (_data_->_async_result);
	return FALSE;
}


static void deja_dup_operation_backup_real_send_action_file_changed (DejaDupOperation* base, GFile* file, gboolean actual) {
	DejaDupOperationBackup * self;
	GFile* _tmp0_;
	GFile* _tmp1_;
	gboolean _tmp2_ = FALSE;
	self = (DejaDupOperationBackup*) base;
	g_return_if_fail (file != NULL);
	_tmp0_ = file;
	_tmp1_ = self->priv->metadir;
	_tmp2_ = g_file_has_prefix (_tmp0_, _tmp1_);
	if (!_tmp2_) {
		GFile* _tmp3_;
		gboolean _tmp4_;
		_tmp3_ = file;
		_tmp4_ = actual;
		DEJA_DUP_OPERATION_CLASS (deja_dup_operation_backup_parent_class)->send_action_file_changed (DEJA_DUP_OPERATION (self), _tmp3_, _tmp4_);
	}
}


static gchar* bool_to_string (gboolean self) {
	gchar* result = NULL;
	if (self) {
		gchar* _tmp0_;
		_tmp0_ = g_strdup ("true");
		result = _tmp0_;
		return result;
	} else {
		gchar* _tmp1_;
		_tmp1_ = g_strdup ("false");
		result = _tmp1_;
		return result;
	}
}


static gchar* _variant_get1 (GVariant* value) {
	return g_variant_dup_string (value, NULL);
}


static guint8* string_get_data (const gchar* self, int* result_length1) {
	guint8* result;
	guint8* res;
	gint res_length1;
	gint _res_size_;
	gint _tmp0_;
	gint _tmp1_;
	gint _tmp2_;
	guint8* _tmp3_;
	gint _tmp3__length1;
	guint8* _tmp4_;
	gint _tmp4__length1;
	g_return_val_if_fail (self != NULL, NULL);
	res = (guint8*) self;
	res_length1 = -1;
	_res_size_ = res_length1;
	_tmp0_ = strlen (self);
	_tmp1_ = _tmp0_;
	res_length1 = (gint) _tmp1_;
	_tmp2_ = res_length1;
	_tmp3_ = res;
	_tmp3__length1 = res_length1;
	_tmp4_ = _tmp3_;
	_tmp4__length1 = _tmp3__length1;
	if (result_length1) {
		*result_length1 = _tmp4__length1;
	}
	result = _tmp4_;
	return result;
}


void deja_dup_operation_backup_save_gsettings (DejaDupOperationBackup* self, const gchar* schema) {
	const gchar* _tmp0_;
	DejaDupSimpleSettings* _tmp1_ = NULL;
	DejaDupSimpleSettings* appsetlist;
	DejaDupSimpleSettings* _tmp2_;
	gchar** _tmp3_;
	gchar** _tmp4_ = NULL;
	gchar** keys_val;
	gint keys_val_length1;
	gint _keys_val_size_;
	gchar* _tmp5_;
	gchar* _result_;
	gchar** _tmp6_;
	gint _tmp6__length1;
	DejaDupSimpleSettings* _tmp112_;
	gchar** _tmp113_;
	gchar** _tmp114_ = NULL;
	gchar** children_val;
	gint children_val_length1;
	gint _children_val_size_;
	gchar** _tmp115_;
	gint _tmp115__length1;
	GError * _inner_error_ = NULL;
	g_return_if_fail (self != NULL);
	g_return_if_fail (schema != NULL);
	_tmp0_ = schema;
	_tmp1_ = deja_dup_get_app_settings (_tmp0_, NULL);
	appsetlist = _tmp1_;
	_tmp2_ = appsetlist;
	_tmp4_ = _tmp3_ = g_settings_list_keys ((GSettings*) _tmp2_);
	keys_val = _tmp4_;
	keys_val_length1 = _vala_array_length (_tmp3_);
	_keys_val_size_ = keys_val_length1;
	_tmp5_ = g_strdup ("");
	_result_ = _tmp5_;
	_tmp6_ = keys_val;
	_tmp6__length1 = keys_val_length1;
	{
		gchar** s_collection = NULL;
		gint s_collection_length1 = 0;
		gint _s_collection_size_ = 0;
		gint s_it = 0;
		s_collection = _tmp6_;
		s_collection_length1 = _tmp6__length1;
		for (s_it = 0; s_it < _tmp6__length1; s_it = s_it + 1) {
			gchar* _tmp7_;
			gchar* s = NULL;
			_tmp7_ = g_strdup (s_collection[s_it]);
			s = _tmp7_;
			{
				DejaDupSimpleSettings* _tmp8_;
				const gchar* _tmp9_;
				GVariant* _tmp10_ = NULL;
				GVariant* t_val;
				GVariant* _tmp11_;
				const gchar* _tmp12_ = NULL;
				gchar* _tmp13_;
				gchar* type;
				const gchar* _tmp14_;
				const gchar* _tmp29_;
				const gchar* _tmp44_;
				const gchar* _tmp57_;
				const gchar* _tmp81_ = NULL;
				gchar* _tmp82_;
				gchar* home_dir;
				const gchar* _tmp83_;
				gchar* _tmp84_;
				gchar* _tmp85_;
				GFile* _tmp86_ = NULL;
				GFile* _tmp87_;
				GFile* file;
				GFileOutputStream* os = NULL;
				_tmp8_ = appsetlist;
				_tmp9_ = s;
				_tmp10_ = g_settings_get_value ((GSettings*) _tmp8_, _tmp9_);
				t_val = _tmp10_;
				_tmp11_ = t_val;
				_tmp12_ = g_variant_get_type_string (_tmp11_);
				_tmp13_ = g_strdup (_tmp12_);
				type = _tmp13_;
				_tmp14_ = type;
				if (g_strcmp0 ("b", _tmp14_) == 0) {
					const gchar* _tmp15_;
					gchar* _tmp16_;
					gchar* _tmp17_;
					const gchar* _tmp18_;
					gchar* _tmp19_;
					gchar* _tmp20_;
					gchar* _tmp21_;
					gchar* _tmp22_;
					DejaDupSimpleSettings* _tmp23_;
					const gchar* _tmp24_;
					gboolean _tmp25_ = FALSE;
					gchar* _tmp26_ = NULL;
					gchar* _tmp27_;
					gchar* _tmp28_;
					_tmp15_ = schema;
					_tmp16_ = g_strconcat (_tmp15_, " ", NULL);
					_tmp17_ = _tmp16_;
					_tmp18_ = s;
					_tmp19_ = g_strconcat (_tmp17_, _tmp18_, NULL);
					_tmp20_ = _tmp19_;
					_tmp21_ = g_strconcat (_tmp20_, " ", NULL);
					_tmp22_ = _tmp21_;
					_tmp23_ = appsetlist;
					_tmp24_ = s;
					_tmp25_ = g_settings_get_boolean ((GSettings*) _tmp23_, _tmp24_);
					_tmp26_ = bool_to_string (_tmp25_);
					_tmp27_ = _tmp26_;
					_tmp28_ = g_strconcat (_tmp22_, _tmp27_, NULL);
					_g_free0 (_result_);
					_result_ = _tmp28_;
					_g_free0 (_tmp27_);
					_g_free0 (_tmp22_);
					_g_free0 (_tmp20_);
					_g_free0 (_tmp17_);
				}
				_tmp29_ = type;
				if (g_strcmp0 ("i", _tmp29_) == 0) {
					const gchar* _tmp30_;
					gchar* _tmp31_;
					gchar* _tmp32_;
					const gchar* _tmp33_;
					gchar* _tmp34_;
					gchar* _tmp35_;
					gchar* _tmp36_;
					gchar* _tmp37_;
					DejaDupSimpleSettings* _tmp38_;
					const gchar* _tmp39_;
					gint _tmp40_ = 0;
					gchar* _tmp41_ = NULL;
					gchar* _tmp42_;
					gchar* _tmp43_;
					_tmp30_ = schema;
					_tmp31_ = g_strconcat (_tmp30_, " ", NULL);
					_tmp32_ = _tmp31_;
					_tmp33_ = s;
					_tmp34_ = g_strconcat (_tmp32_, _tmp33_, NULL);
					_tmp35_ = _tmp34_;
					_tmp36_ = g_strconcat (_tmp35_, " ", NULL);
					_tmp37_ = _tmp36_;
					_tmp38_ = appsetlist;
					_tmp39_ = s;
					_tmp40_ = g_settings_get_int ((GSettings*) _tmp38_, _tmp39_);
					_tmp41_ = g_strdup_printf ("%i", _tmp40_);
					_tmp42_ = _tmp41_;
					_tmp43_ = g_strconcat (_tmp37_, _tmp42_, NULL);
					_g_free0 (_result_);
					_result_ = _tmp43_;
					_g_free0 (_tmp42_);
					_g_free0 (_tmp37_);
					_g_free0 (_tmp35_);
					_g_free0 (_tmp32_);
				}
				_tmp44_ = type;
				if (g_strcmp0 ("s", _tmp44_) == 0) {
					const gchar* _tmp45_;
					gchar* _tmp46_;
					gchar* _tmp47_;
					const gchar* _tmp48_;
					gchar* _tmp49_;
					gchar* _tmp50_;
					gchar* _tmp51_;
					gchar* _tmp52_;
					GVariant* _tmp53_;
					gchar* _tmp54_;
					gchar* _tmp55_;
					gchar* _tmp56_;
					_tmp45_ = schema;
					_tmp46_ = g_strconcat (_tmp45_, " ", NULL);
					_tmp47_ = _tmp46_;
					_tmp48_ = s;
					_tmp49_ = g_strconcat (_tmp47_, _tmp48_, NULL);
					_tmp50_ = _tmp49_;
					_tmp51_ = g_strconcat (_tmp50_, " ", NULL);
					_tmp52_ = _tmp51_;
					_tmp53_ = t_val;
					_tmp54_ = _variant_get1 (_tmp53_);
					_tmp55_ = _tmp54_;
					_tmp56_ = g_strconcat (_tmp52_, _tmp55_, NULL);
					_g_free0 (_result_);
					_result_ = _tmp56_;
					_g_free0 (_tmp55_);
					_g_free0 (_tmp52_);
					_g_free0 (_tmp50_);
					_g_free0 (_tmp47_);
				}
				_tmp57_ = type;
				if (g_strcmp0 ("as", _tmp57_) == 0) {
					const gchar* _tmp58_;
					gchar* _tmp59_;
					gchar* _tmp60_;
					const gchar* _tmp61_;
					gchar* _tmp62_;
					gchar* _tmp63_;
					gchar* _tmp64_;
					GVariant* _tmp65_;
					size_t _tmp66_;
					const gchar** _tmp67_ = NULL;
					const gchar** list;
					gint list_length1;
					gint _list_size_;
					const gchar** _tmp68_;
					gint _tmp68__length1;
					_tmp58_ = schema;
					_tmp59_ = g_strconcat (_tmp58_, " ", NULL);
					_tmp60_ = _tmp59_;
					_tmp61_ = s;
					_tmp62_ = g_strconcat (_tmp60_, _tmp61_, NULL);
					_tmp63_ = _tmp62_;
					_tmp64_ = g_strconcat (_tmp63_, " ", NULL);
					_g_free0 (_result_);
					_result_ = _tmp64_;
					_g_free0 (_tmp63_);
					_g_free0 (_tmp60_);
					_tmp65_ = t_val;
					_tmp67_ = g_variant_get_strv (_tmp65_, &_tmp66_);
					list = _tmp67_;
					list_length1 = _tmp66_;
					_list_size_ = list_length1;
					_tmp68_ = list;
					_tmp68__length1 = list_length1;
					{
						const gchar** ss_collection = NULL;
						gint ss_collection_length1 = 0;
						gint _ss_collection_size_ = 0;
						gint ss_it = 0;
						ss_collection = _tmp68_;
						ss_collection_length1 = _tmp68__length1;
						for (ss_it = 0; ss_it < _tmp68__length1; ss_it = ss_it + 1) {
							gchar* _tmp69_;
							gchar* ss = NULL;
							_tmp69_ = g_strdup ((gchar*) ss_collection[ss_it]);
							ss = _tmp69_;
							{
								const gchar** _tmp70_;
								gint _tmp70__length1;
								const gchar* _tmp71_;
								const gchar* _tmp72_;
								_tmp70_ = list;
								_tmp70__length1 = list_length1;
								_tmp71_ = _tmp70_[0];
								_tmp72_ = ss;
								if (g_strcmp0 (_tmp71_, _tmp72_) == 0) {
									const gchar* _tmp73_;
									const gchar* _tmp74_;
									gchar* _tmp75_;
									_tmp73_ = _result_;
									_tmp74_ = ss;
									_tmp75_ = g_strconcat (_tmp73_, _tmp74_, NULL);
									_g_free0 (_result_);
									_result_ = _tmp75_;
								} else {
									const gchar* _tmp76_;
									gchar* _tmp77_;
									gchar* _tmp78_;
									const gchar* _tmp79_;
									gchar* _tmp80_;
									_tmp76_ = _result_;
									_tmp77_ = g_strconcat (_tmp76_, ",", NULL);
									_tmp78_ = _tmp77_;
									_tmp79_ = ss;
									_tmp80_ = g_strconcat (_tmp78_, _tmp79_, NULL);
									_g_free0 (_result_);
									_result_ = _tmp80_;
									_g_free0 (_tmp78_);
								}
								_g_free0 (ss);
							}
						}
					}
					list = (g_free (list), NULL);
				}
				_tmp81_ = g_get_home_dir ();
				_tmp82_ = g_strdup (_tmp81_);
				home_dir = _tmp82_;
				_tmp83_ = home_dir;
				_tmp84_ = g_strconcat (_tmp83_, "/.apps-gsettings", NULL);
				_tmp85_ = _tmp84_;
				_tmp86_ = g_file_new_for_path (_tmp85_);
				_tmp87_ = _tmp86_;
				_g_free0 (_tmp85_);
				file = _tmp87_;
				{
					GFile* _tmp88_;
					gboolean _tmp89_ = FALSE;
					gboolean tmp;
					gboolean _tmp90_;
					_tmp88_ = file;
					_tmp89_ = g_file_query_exists (_tmp88_, NULL);
					tmp = _tmp89_;
					_tmp90_ = tmp;
					if (_tmp90_ == TRUE) {
						GFile* _tmp91_;
						GFileOutputStream* _tmp92_ = NULL;
						GFileOutputStream* _tmp93_;
						GFileOutputStream* _tmp94_;
						const gchar* _tmp95_;
						gchar* _tmp96_;
						gchar* _tmp97_;
						guint8* _tmp98_;
						gint _tmp98__length1;
						guint8* _tmp99_;
						gint _tmp99__length1;
						_tmp91_ = file;
						_tmp92_ = g_file_append_to (_tmp91_, G_FILE_CREATE_NONE, NULL, &_inner_error_);
						_tmp93_ = _tmp92_;
						if (_inner_error_ != NULL) {
							goto __catch24_g_error;
						}
						_g_object_unref0 (os);
						os = _tmp93_;
						_tmp94_ = os;
						_tmp95_ = _result_;
						_tmp96_ = g_strconcat (_tmp95_, "\n", NULL);
						_tmp97_ = _tmp96_;
						_tmp98_ = string_get_data (_tmp97_, &_tmp98__length1);
						_tmp99_ = _tmp98_;
						_tmp99__length1 = _tmp98__length1;
						g_output_stream_write ((GOutputStream*) _tmp94_, _tmp99_, (gsize) _tmp99__length1, NULL, &_inner_error_);
						_g_free0 (_tmp97_);
						if (_inner_error_ != NULL) {
							goto __catch24_g_error;
						}
					} else {
						GFile* _tmp100_;
						GFileOutputStream* _tmp101_ = NULL;
						GFileOutputStream* _tmp102_;
						GFileOutputStream* _tmp103_;
						const gchar* _tmp104_;
						gchar* _tmp105_;
						gchar* _tmp106_;
						guint8* _tmp107_;
						gint _tmp107__length1;
						guint8* _tmp108_;
						gint _tmp108__length1;
						_tmp100_ = file;
						_tmp101_ = g_file_create (_tmp100_, G_FILE_CREATE_PRIVATE, NULL, &_inner_error_);
						_tmp102_ = _tmp101_;
						if (_inner_error_ != NULL) {
							goto __catch24_g_error;
						}
						_g_object_unref0 (os);
						os = _tmp102_;
						_tmp103_ = os;
						_tmp104_ = _result_;
						_tmp105_ = g_strconcat (_tmp104_, "\n", NULL);
						_tmp106_ = _tmp105_;
						_tmp107_ = string_get_data (_tmp106_, &_tmp107__length1);
						_tmp108_ = _tmp107_;
						_tmp108__length1 = _tmp107__length1;
						g_output_stream_write ((GOutputStream*) _tmp103_, _tmp108_, (gsize) _tmp108__length1, NULL, &_inner_error_);
						_g_free0 (_tmp106_);
						if (_inner_error_ != NULL) {
							goto __catch24_g_error;
						}
					}
				}
				goto __finally24;
				__catch24_g_error:
				{
					GError* e = NULL;
					FILE* _tmp109_;
					GError* _tmp110_;
					const gchar* _tmp111_;
					e = _inner_error_;
					_inner_error_ = NULL;
					_tmp109_ = stdout;
					_tmp110_ = e;
					_tmp111_ = _tmp110_->message;
					fprintf (_tmp109_, "Error: %s\n", _tmp111_);
					_g_error_free0 (e);
				}
				__finally24:
				if (_inner_error_ != NULL) {
					_g_object_unref0 (os);
					_g_object_unref0 (file);
					_g_free0 (home_dir);
					_g_free0 (type);
					_g_variant_unref0 (t_val);
					_g_free0 (s);
					_g_free0 (_result_);
					keys_val = (_vala_array_free (keys_val, keys_val_length1, (GDestroyNotify) g_free), NULL);
					_g_object_unref0 (appsetlist);
					g_critical ("file %s: line %d: uncaught error: %s (%s, %d)", __FILE__, __LINE__, _inner_error_->message, g_quark_to_string (_inner_error_->domain), _inner_error_->code);
					g_clear_error (&_inner_error_);
					return;
				}
				_g_object_unref0 (os);
				_g_object_unref0 (file);
				_g_free0 (home_dir);
				_g_free0 (type);
				_g_variant_unref0 (t_val);
				_g_free0 (s);
			}
		}
	}
	_tmp112_ = appsetlist;
	_tmp114_ = _tmp113_ = g_settings_list_children ((GSettings*) _tmp112_);
	children_val = _tmp114_;
	children_val_length1 = _vala_array_length (_tmp113_);
	_children_val_size_ = children_val_length1;
	_tmp115_ = children_val;
	_tmp115__length1 = children_val_length1;
	{
		gchar** child_collection = NULL;
		gint child_collection_length1 = 0;
		gint _child_collection_size_ = 0;
		gint child_it = 0;
		child_collection = _tmp115_;
		child_collection_length1 = _tmp115__length1;
		for (child_it = 0; child_it < _tmp115__length1; child_it = child_it + 1) {
			gchar* _tmp116_;
			gchar* child = NULL;
			_tmp116_ = g_strdup (child_collection[child_it]);
			child = _tmp116_;
			{
				DejaDupSimpleSettings* _tmp117_;
				const gchar* _tmp118_;
				GSettings* _tmp119_ = NULL;
				GSettings* _tmp120_;
				gchar* _tmp121_ = NULL;
				gchar* _tmp122_;
				gchar* _tmp123_;
				_tmp117_ = appsetlist;
				_tmp118_ = child;
				_tmp119_ = g_settings_get_child ((GSettings*) _tmp117_, _tmp118_);
				_tmp120_ = _tmp119_;
				g_object_get (_tmp120_, "schema", &_tmp121_, NULL);
				_tmp122_ = _tmp121_;
				_tmp123_ = _tmp122_;
				deja_dup_operation_backup_save_gsettings (self, _tmp123_);
				_g_free0 (_tmp123_);
				_g_object_unref0 (_tmp120_);
				_g_free0 (child);
			}
		}
	}
	children_val = (_vala_array_free (children_val, children_val_length1, (GDestroyNotify) g_free), NULL);
	_g_free0 (_result_);
	keys_val = (_vala_array_free (keys_val, keys_val_length1, (GDestroyNotify) g_free), NULL);
	_g_object_unref0 (appsetlist);
}


static void _g_free0_ (gpointer var) {
	var = (g_free (var), NULL);
}


static void _g_list_free__g_free0_ (GList* self) {
	g_list_foreach (self, (GFunc) _g_free0_, NULL);
	g_list_free (self);
}


static GList* deja_dup_operation_backup_real_make_argv (DejaDupOperation* base) {
	DejaDupOperationBackup * self;
	GList* result = NULL;
	DejaDupSimpleSettings* _tmp0_ = NULL;
	DejaDupSimpleSettings* settings;
	DejaDupSimpleSettings* _tmp1_;
	GVariant* _tmp2_ = NULL;
	GVariant* include_val;
	GVariant* _tmp3_;
	size_t _tmp4_;
	const gchar** _tmp5_ = NULL;
	const gchar** _tmp6_;
	gint _tmp6__length1;
	gint _tmp7_ = 0;
	GFile** _tmp8_ = NULL;
	GFile** _tmp9_;
	gint _tmp9__length1;
	GFile** include_list;
	gint include_list_length1;
	gint _include_list_size_;
	DejaDupSimpleSettings* _tmp10_;
	GVariant* _tmp11_ = NULL;
	GVariant* exclude_val;
	GVariant* _tmp12_;
	size_t _tmp13_;
	const gchar** _tmp14_ = NULL;
	const gchar** _tmp15_;
	gint _tmp15__length1;
	gint _tmp16_ = 0;
	GFile** _tmp17_ = NULL;
	GFile** _tmp18_;
	gint _tmp18__length1;
	GFile** exclude_list;
	gint exclude_list_length1;
	gint _exclude_list_size_;
	DejaDupSimpleSettings* _tmp19_ = NULL;
	DejaDupSimpleSettings* apps_settings;
	DejaDupSimpleSettings* _tmp20_;
	GVariant* _tmp21_ = NULL;
	GVariant* apps_val;
	GVariant* _tmp22_;
	size_t _tmp23_;
	const gchar** _tmp24_ = NULL;
	const gchar** _tmp25_;
	gint _tmp25__length1;
	gint _tmp26_ = 0;
	GFile** _tmp27_ = NULL;
	GFile** _tmp28_;
	gint _tmp28__length1;
	GFile** apps_list;
	gint apps_list_length1;
	gint _apps_list_size_;
	GList* _tmp29_ = NULL;
	GList* always_excluded;
	GList* _tmp30_;
	GFile** _tmp35_;
	gint _tmp35__length1;
	GFile** _tmp40_;
	gint _tmp40__length1;
	GFile** _tmp45_;
	gint _tmp45__length1;
	const gchar* _tmp50_ = NULL;
	gchar* _tmp51_;
	gchar* home_dir;
	const gchar* _tmp52_;
	gchar* _tmp53_;
	gchar* _tmp54_;
	GFile* _tmp55_ = NULL;
	GFile* _tmp56_;
	GFile* file_save;
	GFile* _tmp57_;
	gboolean _tmp58_ = FALSE;
	gboolean tmp;
	gboolean _tmp59_;
	DejaDupSimpleSettings* _tmp70_ = NULL;
	DejaDupSimpleSettings* app_settings;
	DejaDupSimpleSettings* _tmp71_;
	gchar** _tmp72_;
	gchar** _tmp73_ = NULL;
	const gchar* _tmp94_ = NULL;
	gchar* _tmp95_;
	gchar* cachedir;
	DejaDupToolJob* _tmp104_;
	GFile* _tmp105_ = NULL;
	GFile* _tmp106_;
	GError * _inner_error_ = NULL;
	self = (DejaDupOperationBackup*) base;
	_tmp0_ = deja_dup_get_settings (NULL);
	settings = _tmp0_;
	_tmp1_ = settings;
	_tmp2_ = g_settings_get_value ((GSettings*) _tmp1_, DEJA_DUP_INCLUDE_LIST_KEY);
	include_val = _tmp2_;
	_tmp3_ = include_val;
	_tmp5_ = g_variant_get_strv (_tmp3_, &_tmp4_);
	_tmp6_ = _tmp5_;
	_tmp6__length1 = _tmp4_;
	_tmp8_ = deja_dup_parse_dir_list (_tmp6_, _tmp4_, &_tmp7_);
	_tmp9_ = _tmp8_;
	_tmp9__length1 = _tmp7_;
	_tmp6_ = (g_free (_tmp6_), NULL);
	include_list = _tmp9_;
	include_list_length1 = _tmp9__length1;
	_include_list_size_ = include_list_length1;
	_tmp10_ = settings;
	_tmp11_ = g_settings_get_value ((GSettings*) _tmp10_, DEJA_DUP_EXCLUDE_LIST_KEY);
	exclude_val = _tmp11_;
	_tmp12_ = exclude_val;
	_tmp14_ = g_variant_get_strv (_tmp12_, &_tmp13_);
	_tmp15_ = _tmp14_;
	_tmp15__length1 = _tmp13_;
	_tmp17_ = deja_dup_parse_dir_list (_tmp15_, _tmp13_, &_tmp16_);
	_tmp18_ = _tmp17_;
	_tmp18__length1 = _tmp16_;
	_tmp15_ = (g_free (_tmp15_), NULL);
	exclude_list = _tmp18_;
	exclude_list_length1 = _tmp18__length1;
	_exclude_list_size_ = exclude_list_length1;
	_tmp19_ = deja_dup_get_settings (DEJA_DUP_APPS_ROOT);
	apps_settings = _tmp19_;
	_tmp20_ = apps_settings;
	_tmp21_ = g_settings_get_value ((GSettings*) _tmp20_, DEJA_DUP_APPS_LIST_KEY);
	apps_val = _tmp21_;
	_tmp22_ = apps_val;
	_tmp24_ = g_variant_get_strv (_tmp22_, &_tmp23_);
	_tmp25_ = _tmp24_;
	_tmp25__length1 = _tmp23_;
	_tmp27_ = deja_dup_parse_dir_list (_tmp25_, _tmp23_, &_tmp26_);
	_tmp28_ = _tmp27_;
	_tmp28__length1 = _tmp26_;
	_tmp25_ = (g_free (_tmp25_), NULL);
	apps_list = _tmp28_;
	apps_list_length1 = _tmp28__length1;
	_apps_list_size_ = apps_list_length1;
	_tmp29_ = deja_dup_operation_backup_get_always_excluded_dirs (self);
	always_excluded = _tmp29_;
	_tmp30_ = always_excluded;
	{
		GList* dir_collection = NULL;
		GList* dir_it = NULL;
		dir_collection = _tmp30_;
		for (dir_it = dir_collection; dir_it != NULL; dir_it = dir_it->next) {
			gchar* _tmp31_;
			gchar* dir = NULL;
			_tmp31_ = g_strdup ((const gchar*) dir_it->data);
			dir = _tmp31_;
			{
				DejaDupToolJob* _tmp32_;
				const gchar* _tmp33_;
				GFile* _tmp34_ = NULL;
				_tmp32_ = ((DejaDupOperation*) self)->job;
				_tmp33_ = dir;
				_tmp34_ = g_file_new_for_path (_tmp33_);
				_tmp32_->excludes = g_list_prepend (_tmp32_->excludes, _tmp34_);
				_g_free0 (dir);
			}
		}
	}
	_tmp35_ = exclude_list;
	_tmp35__length1 = exclude_list_length1;
	{
		GFile** s_collection = NULL;
		gint s_collection_length1 = 0;
		gint _s_collection_size_ = 0;
		gint s_it = 0;
		s_collection = _tmp35_;
		s_collection_length1 = _tmp35__length1;
		for (s_it = 0; s_it < _tmp35__length1; s_it = s_it + 1) {
			GFile* _tmp36_;
			GFile* s = NULL;
			_tmp36_ = _g_object_ref0 (s_collection[s_it]);
			s = _tmp36_;
			{
				DejaDupToolJob* _tmp37_;
				GFile* _tmp38_;
				GFile* _tmp39_;
				_tmp37_ = ((DejaDupOperation*) self)->job;
				_tmp38_ = s;
				_tmp39_ = _g_object_ref0 (_tmp38_);
				_tmp37_->excludes = g_list_prepend (_tmp37_->excludes, _tmp39_);
				_g_object_unref0 (s);
			}
		}
	}
	_tmp40_ = include_list;
	_tmp40__length1 = include_list_length1;
	{
		GFile** s_collection = NULL;
		gint s_collection_length1 = 0;
		gint _s_collection_size_ = 0;
		gint s_it = 0;
		s_collection = _tmp40_;
		s_collection_length1 = _tmp40__length1;
		for (s_it = 0; s_it < _tmp40__length1; s_it = s_it + 1) {
			GFile* _tmp41_;
			GFile* s = NULL;
			_tmp41_ = _g_object_ref0 (s_collection[s_it]);
			s = _tmp41_;
			{
				DejaDupToolJob* _tmp42_;
				GFile* _tmp43_;
				GFile* _tmp44_;
				_tmp42_ = ((DejaDupOperation*) self)->job;
				_tmp43_ = s;
				_tmp44_ = _g_object_ref0 (_tmp43_);
				_tmp42_->includes = g_list_prepend (_tmp42_->includes, _tmp44_);
				_g_object_unref0 (s);
			}
		}
	}
	_tmp45_ = apps_list;
	_tmp45__length1 = apps_list_length1;
	{
		GFile** s_collection = NULL;
		gint s_collection_length1 = 0;
		gint _s_collection_size_ = 0;
		gint s_it = 0;
		s_collection = _tmp45_;
		s_collection_length1 = _tmp45__length1;
		for (s_it = 0; s_it < _tmp45__length1; s_it = s_it + 1) {
			GFile* _tmp46_;
			GFile* s = NULL;
			_tmp46_ = _g_object_ref0 (s_collection[s_it]);
			s = _tmp46_;
			{
				DejaDupToolJob* _tmp47_;
				GFile* _tmp48_;
				GFile* _tmp49_;
				_tmp47_ = ((DejaDupOperation*) self)->job;
				_tmp48_ = s;
				_tmp49_ = _g_object_ref0 (_tmp48_);
				_tmp47_->includes = g_list_prepend (_tmp47_->includes, _tmp49_);
				_g_object_unref0 (s);
			}
		}
	}
	_tmp50_ = g_get_home_dir ();
	_tmp51_ = g_strdup (_tmp50_);
	home_dir = _tmp51_;
	_tmp52_ = home_dir;
	_tmp53_ = g_strconcat (_tmp52_, "/.apps-gsettings", NULL);
	_tmp54_ = _tmp53_;
	_tmp55_ = g_file_new_for_path (_tmp54_);
	_tmp56_ = _tmp55_;
	_g_free0 (_tmp54_);
	file_save = _tmp56_;
	_tmp57_ = file_save;
	_tmp58_ = g_file_query_exists (_tmp57_, NULL);
	tmp = _tmp58_;
	_tmp59_ = tmp;
	if (_tmp59_ == TRUE) {
		{
			GFile* _tmp60_;
			_tmp60_ = file_save;
			g_file_delete (_tmp60_, NULL, &_inner_error_);
			if (_inner_error_ != NULL) {
				goto __catch25_g_error;
			}
		}
		goto __finally25;
		__catch25_g_error:
		{
			GError* e = NULL;
			FILE* _tmp61_;
			GError* _tmp62_;
			const gchar* _tmp63_;
			e = _inner_error_;
			_inner_error_ = NULL;
			_tmp61_ = stdout;
			_tmp62_ = e;
			_tmp63_ = _tmp62_->message;
			fprintf (_tmp61_, "Error: %s\n", _tmp63_);
			_g_error_free0 (e);
		}
		__finally25:
		if (_inner_error_ != NULL) {
			_g_object_unref0 (file_save);
			_g_free0 (home_dir);
			__g_list_free__g_free0_0 (always_excluded);
			apps_list = (_vala_array_free (apps_list, apps_list_length1, (GDestroyNotify) g_object_unref), NULL);
			_g_variant_unref0 (apps_val);
			_g_object_unref0 (apps_settings);
			exclude_list = (_vala_array_free (exclude_list, exclude_list_length1, (GDestroyNotify) g_object_unref), NULL);
			_g_variant_unref0 (exclude_val);
			include_list = (_vala_array_free (include_list, include_list_length1, (GDestroyNotify) g_object_unref), NULL);
			_g_variant_unref0 (include_val);
			_g_object_unref0 (settings);
			g_critical ("file %s: line %d: uncaught error: %s (%s, %d)", __FILE__, __LINE__, _inner_error_->message, g_quark_to_string (_inner_error_->domain), _inner_error_->code);
			g_clear_error (&_inner_error_);
			return NULL;
		}
	} else {
		{
			GFile* _tmp64_;
			GFileOutputStream* _tmp65_ = NULL;
			GFileOutputStream* _tmp66_;
			_tmp64_ = file_save;
			_tmp65_ = g_file_create (_tmp64_, G_FILE_CREATE_PRIVATE, NULL, &_inner_error_);
			_tmp66_ = _tmp65_;
			_g_object_unref0 (_tmp66_);
			if (_inner_error_ != NULL) {
				goto __catch26_g_error;
			}
		}
		goto __finally26;
		__catch26_g_error:
		{
			GError* e = NULL;
			FILE* _tmp67_;
			GError* _tmp68_;
			const gchar* _tmp69_;
			e = _inner_error_;
			_inner_error_ = NULL;
			_tmp67_ = stdout;
			_tmp68_ = e;
			_tmp69_ = _tmp68_->message;
			fprintf (_tmp67_, "Error: %s\n", _tmp69_);
			_g_error_free0 (e);
		}
		__finally26:
		if (_inner_error_ != NULL) {
			_g_object_unref0 (file_save);
			_g_free0 (home_dir);
			__g_list_free__g_free0_0 (always_excluded);
			apps_list = (_vala_array_free (apps_list, apps_list_length1, (GDestroyNotify) g_object_unref), NULL);
			_g_variant_unref0 (apps_val);
			_g_object_unref0 (apps_settings);
			exclude_list = (_vala_array_free (exclude_list, exclude_list_length1, (GDestroyNotify) g_object_unref), NULL);
			_g_variant_unref0 (exclude_val);
			include_list = (_vala_array_free (include_list, include_list_length1, (GDestroyNotify) g_object_unref), NULL);
			_g_variant_unref0 (include_val);
			_g_object_unref0 (settings);
			g_critical ("file %s: line %d: uncaught error: %s (%s, %d)", __FILE__, __LINE__, _inner_error_->message, g_quark_to_string (_inner_error_->domain), _inner_error_->code);
			g_clear_error (&_inner_error_);
			return NULL;
		}
	}
	_tmp70_ = deja_dup_get_settings (DEJA_DUP_APPS_ROOT);
	app_settings = _tmp70_;
	_tmp71_ = app_settings;
	_tmp73_ = _tmp72_ = g_settings_list_children ((GSettings*) _tmp71_);
	{
		gchar** app_collection = NULL;
		gint app_collection_length1 = 0;
		gint _app_collection_size_ = 0;
		gint app_it = 0;
		app_collection = _tmp73_;
		app_collection_length1 = _vala_array_length (_tmp72_);
		for (app_it = 0; app_it < _vala_array_length (_tmp72_); app_it = app_it + 1) {
			gchar* _tmp74_;
			gchar* app = NULL;
			_tmp74_ = g_strdup (app_collection[app_it]);
			app = _tmp74_;
			{
				const gchar* _tmp75_;
				gchar* _tmp76_;
				gchar* _tmp77_;
				GFile* _tmp78_ = NULL;
				GFile* _tmp79_;
				GFile* file;
				GFile* _tmp80_;
				gboolean _tmp81_ = FALSE;
				_tmp75_ = app;
				_tmp76_ = g_strconcat ("/usr/bin/", _tmp75_, NULL);
				_tmp77_ = _tmp76_;
				_tmp78_ = g_file_new_for_path (_tmp77_);
				_tmp79_ = _tmp78_;
				_g_free0 (_tmp77_);
				file = _tmp79_;
				_tmp80_ = file;
				_tmp81_ = g_file_query_exists (_tmp80_, NULL);
				if (_tmp81_) {
					const gchar* _tmp82_;
					gchar* _tmp83_;
					gchar* _tmp84_;
					DejaDupSimpleSettings* _tmp85_ = NULL;
					DejaDupSimpleSettings* _tmp86_;
					DejaDupSimpleSettings* set;
					DejaDupSimpleSettings* _tmp87_;
					gboolean _tmp88_ = FALSE;
					gboolean val;
					gboolean _tmp89_;
					_tmp82_ = app;
					_tmp83_ = g_strconcat (DEJA_DUP_APPS_ROOT ".", _tmp82_, NULL);
					_tmp84_ = _tmp83_;
					_tmp85_ = deja_dup_get_settings (_tmp84_);
					_tmp86_ = _tmp85_;
					_g_free0 (_tmp84_);
					set = _tmp86_;
					_tmp87_ = set;
					_tmp88_ = g_settings_get_boolean ((GSettings*) _tmp87_, DEJA_DUP_BACKUP_KEY);
					val = _tmp88_;
					_tmp89_ = val;
					if (_tmp89_ == TRUE) {
						DejaDupSimpleSettings* _tmp90_;
						gchar* _tmp91_ = NULL;
						gchar* schema;
						const gchar* _tmp92_;
						_tmp90_ = set;
						_tmp91_ = g_settings_get_string ((GSettings*) _tmp90_, "settings");
						schema = _tmp91_;
						_tmp92_ = schema;
						if (g_strcmp0 (_tmp92_, "") != 0) {
							const gchar* _tmp93_;
							_tmp93_ = schema;
							deja_dup_operation_backup_save_gsettings (self, _tmp93_);
						}
						_g_free0 (schema);
					}
					_g_object_unref0 (set);
				}
				_g_object_unref0 (file);
				_g_free0 (app);
			}
		}
		app_collection = (_vala_array_free (app_collection, app_collection_length1, (GDestroyNotify) g_free), NULL);
	}
	_tmp94_ = g_get_user_cache_dir ();
	_tmp95_ = g_strdup (_tmp94_);
	cachedir = _tmp95_;
	{
		gchar* _tmp96_ = NULL;
		gchar* _tmp97_;
		GFile* _tmp98_ = NULL;
		DejaDupToolJob* _tmp99_;
		GFile* _tmp100_;
		GFile* _tmp101_;
		_tmp96_ = g_build_filename (cachedir, PACKAGE, "metadata", NULL);
		_tmp97_ = _tmp96_;
		_tmp98_ = g_file_new_for_path (_tmp97_);
		_g_object_unref0 (self->priv->metadir);
		self->priv->metadir = _tmp98_;
		_g_free0 (_tmp97_);
		deja_dup_operation_backup_fill_metadir (self, &_inner_error_);
		if (_inner_error_ != NULL) {
			goto __catch27_g_error;
		}
		_tmp99_ = ((DejaDupOperation*) self)->job;
		_tmp100_ = self->priv->metadir;
		_tmp101_ = _g_object_ref0 (_tmp100_);
		_tmp99_->includes = g_list_prepend (_tmp99_->includes, _tmp101_);
	}
	goto __finally27;
	__catch27_g_error:
	{
		GError* e = NULL;
		GError* _tmp102_;
		const gchar* _tmp103_;
		e = _inner_error_;
		_inner_error_ = NULL;
		_tmp102_ = e;
		_tmp103_ = _tmp102_->message;
		g_warning ("OperationBackup.vala:169: %s\n", _tmp103_);
		_g_error_free0 (e);
	}
	__finally27:
	if (_inner_error_ != NULL) {
		_g_free0 (cachedir);
		_g_object_unref0 (app_settings);
		_g_object_unref0 (file_save);
		_g_free0 (home_dir);
		__g_list_free__g_free0_0 (always_excluded);
		apps_list = (_vala_array_free (apps_list, apps_list_length1, (GDestroyNotify) g_object_unref), NULL);
		_g_variant_unref0 (apps_val);
		_g_object_unref0 (apps_settings);
		exclude_list = (_vala_array_free (exclude_list, exclude_list_length1, (GDestroyNotify) g_object_unref), NULL);
		_g_variant_unref0 (exclude_val);
		include_list = (_vala_array_free (include_list, include_list_length1, (GDestroyNotify) g_object_unref), NULL);
		_g_variant_unref0 (include_val);
		_g_object_unref0 (settings);
		g_critical ("file %s: line %d: uncaught error: %s (%s, %d)", __FILE__, __LINE__, _inner_error_->message, g_quark_to_string (_inner_error_->domain), _inner_error_->code);
		g_clear_error (&_inner_error_);
		return NULL;
	}
	_tmp104_ = ((DejaDupOperation*) self)->job;
	_tmp105_ = g_file_new_for_path ("/");
	_tmp106_ = _tmp105_;
	deja_dup_tool_job_set_local (_tmp104_, _tmp106_);
	_g_object_unref0 (_tmp106_);
	result = NULL;
	_g_free0 (cachedir);
	_g_object_unref0 (app_settings);
	_g_object_unref0 (file_save);
	_g_free0 (home_dir);
	__g_list_free__g_free0_0 (always_excluded);
	apps_list = (_vala_array_free (apps_list, apps_list_length1, (GDestroyNotify) g_object_unref), NULL);
	_g_variant_unref0 (apps_val);
	_g_object_unref0 (apps_settings);
	exclude_list = (_vala_array_free (exclude_list, exclude_list_length1, (GDestroyNotify) g_object_unref), NULL);
	_g_variant_unref0 (exclude_val);
	include_list = (_vala_array_free (include_list, include_list_length1, (GDestroyNotify) g_object_unref), NULL);
	_g_variant_unref0 (include_val);
	_g_object_unref0 (settings);
	return result;
}


static GList* deja_dup_operation_backup_get_always_excluded_dirs (DejaDupOperationBackup* self) {
	GList* result = NULL;
	GList* rv;
	const gchar* _tmp0_ = NULL;
	gchar* _tmp1_;
	gchar* dir;
	const gchar* _tmp2_;
	const gchar* _tmp7_ = NULL;
	gchar* _tmp8_;
	const gchar* _tmp9_;
	const gchar* _tmp24_ = NULL;
	gchar* _tmp25_;
	const gchar* _tmp26_;
	gchar* _tmp29_;
	gchar* _tmp30_;
	g_return_val_if_fail (self != NULL, NULL);
	rv = NULL;
	_tmp0_ = g_get_user_cache_dir ();
	_tmp1_ = g_strdup (_tmp0_);
	dir = _tmp1_;
	_tmp2_ = dir;
	if (_tmp2_ != NULL) {
		const gchar* _tmp3_;
		gchar* _tmp4_;
		const gchar* _tmp5_;
		gchar* _tmp6_ = NULL;
		_tmp3_ = dir;
		_tmp4_ = g_strdup (_tmp3_);
		rv = g_list_append (rv, _tmp4_);
		_tmp5_ = dir;
		_tmp6_ = g_build_filename (_tmp5_, PACKAGE, NULL);
		rv = g_list_append (rv, _tmp6_);
	}
	_tmp7_ = g_get_home_dir ();
	_tmp8_ = g_strdup (_tmp7_);
	_g_free0 (dir);
	dir = _tmp8_;
	_tmp9_ = dir;
	if (_tmp9_ != NULL) {
		const gchar* _tmp10_;
		gchar* _tmp11_ = NULL;
		const gchar* _tmp12_;
		gchar* _tmp13_ = NULL;
		const gchar* _tmp14_;
		gchar* _tmp15_ = NULL;
		const gchar* _tmp16_;
		gchar* _tmp17_ = NULL;
		const gchar* _tmp18_;
		gchar* _tmp19_ = NULL;
		const gchar* _tmp20_;
		gchar* _tmp21_ = NULL;
		const gchar* _tmp22_;
		gchar* _tmp23_ = NULL;
		_tmp10_ = dir;
		_tmp11_ = g_build_filename (_tmp10_, ".adobe/Flash_Player/AssetCache", NULL);
		rv = g_list_append (rv, _tmp11_);
		_tmp12_ = dir;
		_tmp13_ = g_build_filename (_tmp12_, ".gvfs", NULL);
		rv = g_list_append (rv, _tmp13_);
		_tmp14_ = dir;
		_tmp15_ = g_build_filename (_tmp14_, ".Private", NULL);
		rv = g_list_append (rv, _tmp15_);
		_tmp16_ = dir;
		_tmp17_ = g_build_filename (_tmp16_, ".recent-applications.xbel", NULL);
		rv = g_list_append (rv, _tmp17_);
		_tmp18_ = dir;
		_tmp19_ = g_build_filename (_tmp18_, ".recently-used.xbel", NULL);
		rv = g_list_append (rv, _tmp19_);
		_tmp20_ = dir;
		_tmp21_ = g_build_filename (_tmp20_, ".thumbnails", NULL);
		rv = g_list_append (rv, _tmp21_);
		_tmp22_ = dir;
		_tmp23_ = g_build_filename (_tmp22_, ".xsession-errors", NULL);
		rv = g_list_append (rv, _tmp23_);
	}
	_tmp24_ = g_get_tmp_dir ();
	_tmp25_ = g_strdup (_tmp24_);
	_g_free0 (dir);
	dir = _tmp25_;
	_tmp26_ = dir;
	if (_tmp26_ != NULL) {
		const gchar* _tmp27_;
		gchar* _tmp28_;
		_tmp27_ = dir;
		_tmp28_ = g_strdup (_tmp27_);
		rv = g_list_append (rv, _tmp28_);
	}
	_tmp29_ = g_strdup ("/proc");
	rv = g_list_append (rv, _tmp29_);
	_tmp30_ = g_strdup ("/sys");
	rv = g_list_append (rv, _tmp30_);
	result = rv;
	_g_free0 (dir);
	return result;
}


static void deja_dup_operation_backup_fill_metadir (DejaDupOperationBackup* self, GError** error) {
	GFile* _tmp0_;
	GFile* _tmp1_;
	DejaDupRecursiveDelete* _tmp2_;
	DejaDupRecursiveDelete* _tmp3_;
	GFile* _tmp4_;
	GDateTime* _tmp5_;
	GDateTime* now;
	GDateTime* _tmp6_;
	gchar* _tmp7_ = NULL;
	gchar* _tmp8_;
	gchar* _tmp9_ = NULL;
	gchar* _tmp10_;
	gchar* msg;
	GFile* _tmp11_;
	gchar* _tmp12_ = NULL;
	gchar* _tmp13_;
	gchar* _tmp14_ = NULL;
	gchar* _tmp15_;
	const gchar* _tmp16_;
	GError * _inner_error_ = NULL;
	g_return_if_fail (self != NULL);
	_tmp0_ = self->priv->metadir;
	if (_tmp0_ == NULL) {
		return;
	}
	_tmp1_ = self->priv->metadir;
	_tmp2_ = deja_dup_recursive_delete_new (_tmp1_);
	_tmp3_ = _tmp2_;
	deja_dup_recursive_op_start ((DejaDupRecursiveOp*) _tmp3_);
	_g_object_unref0 (_tmp3_);
	_tmp4_ = self->priv->metadir;
	g_file_make_directory_with_parents (_tmp4_, NULL, &_inner_error_);
	if (_inner_error_ != NULL) {
		g_propagate_error (error, _inner_error_);
		return;
	}
	_tmp5_ = g_date_time_new_now_utc ();
	now = _tmp5_;
	_tmp6_ = now;
	_tmp7_ = g_date_time_format (_tmp6_, "%s");
	_tmp8_ = _tmp7_;
	_tmp9_ = g_strdup_printf ("This folder can be safely deleted.\n%s", _tmp8_);
	_tmp10_ = _tmp9_;
	_g_free0 (_tmp8_);
	msg = _tmp10_;
	_tmp11_ = self->priv->metadir;
	_tmp12_ = g_file_get_path (_tmp11_);
	_tmp13_ = _tmp12_;
	_tmp14_ = g_build_filename (_tmp13_, "README", NULL);
	_tmp15_ = _tmp14_;
	_tmp16_ = msg;
	g_file_set_contents (_tmp15_, _tmp16_, (gssize) (-1), &_inner_error_);
	_g_free0 (_tmp15_);
	_g_free0 (_tmp13_);
	if (_inner_error_ != NULL) {
		g_propagate_error (error, _inner_error_);
		_g_free0 (msg);
		_g_date_time_unref0 (now);
		return;
	}
	_g_free0 (msg);
	_g_date_time_unref0 (now);
}


static void deja_dup_operation_backup_class_init (DejaDupOperationBackupClass * klass) {
	deja_dup_operation_backup_parent_class = g_type_class_peek_parent (klass);
	g_type_class_add_private (klass, sizeof (DejaDupOperationBackupPrivate));
	DEJA_DUP_OPERATION_CLASS (klass)->operation_finished = deja_dup_operation_backup_real_operation_finished;
	DEJA_DUP_OPERATION_CLASS (klass)->operation_finished_finish = deja_dup_operation_backup_real_operation_finished_finish;
	DEJA_DUP_OPERATION_CLASS (klass)->send_action_file_changed = deja_dup_operation_backup_real_send_action_file_changed;
	DEJA_DUP_OPERATION_CLASS (klass)->make_argv = deja_dup_operation_backup_real_make_argv;
	G_OBJECT_CLASS (klass)->finalize = deja_dup_operation_backup_finalize;
}


static void deja_dup_operation_backup_instance_init (DejaDupOperationBackup * self) {
	self->priv = DEJA_DUP_OPERATION_BACKUP_GET_PRIVATE (self);
}


static void deja_dup_operation_backup_finalize (GObject* obj) {
	DejaDupOperationBackup * self;
	self = DEJA_DUP_OPERATION_BACKUP (obj);
	_g_object_unref0 (self->priv->metadir);
	G_OBJECT_CLASS (deja_dup_operation_backup_parent_class)->finalize (obj);
}


GType deja_dup_operation_backup_get_type (void) {
	static volatile gsize deja_dup_operation_backup_type_id__volatile = 0;
	if (g_once_init_enter (&deja_dup_operation_backup_type_id__volatile)) {
		static const GTypeInfo g_define_type_info = { sizeof (DejaDupOperationBackupClass), (GBaseInitFunc) NULL, (GBaseFinalizeFunc) NULL, (GClassInitFunc) deja_dup_operation_backup_class_init, (GClassFinalizeFunc) NULL, NULL, sizeof (DejaDupOperationBackup), 0, (GInstanceInitFunc) deja_dup_operation_backup_instance_init, NULL };
		GType deja_dup_operation_backup_type_id;
		deja_dup_operation_backup_type_id = g_type_register_static (DEJA_DUP_TYPE_OPERATION, "DejaDupOperationBackup", &g_define_type_info, 0);
		g_once_init_leave (&deja_dup_operation_backup_type_id__volatile, deja_dup_operation_backup_type_id);
	}
	return deja_dup_operation_backup_type_id__volatile;
}


static void _vala_array_destroy (gpointer array, gint array_length, GDestroyNotify destroy_func) {
	if ((array != NULL) && (destroy_func != NULL)) {
		int i;
		for (i = 0; i < array_length; i = i + 1) {
			if (((gpointer*) array)[i] != NULL) {
				destroy_func (((gpointer*) array)[i]);
			}
		}
	}
}


static void _vala_array_free (gpointer array, gint array_length, GDestroyNotify destroy_func) {
	_vala_array_destroy (array, array_length, destroy_func);
	g_free (array);
}


static gint _vala_array_length (gpointer array) {
	int length;
	length = 0;
	if (array) {
		while (((gpointer*) array)[length]) {
			length++;
		}
	}
	return length;
}



