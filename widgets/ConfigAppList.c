/* ConfigAppList.c generated by valac 0.16.1, the Vala compiler
 * generated from ConfigAppList.vala, do not modify */

/* -*- Mode: Vala; indent-tabs-mode: nil; tab-width: 2 -*- */

#include <glib.h>
#include <glib-object.h>
#include <gtk/gtk.h>
#include <gio/gio.h>
#include <common.h>
#include <stdlib.h>
#include <string.h>


#define DEJA_DUP_TYPE_CONFIG_WIDGET (deja_dup_config_widget_get_type ())
#define DEJA_DUP_CONFIG_WIDGET(obj) (G_TYPE_CHECK_INSTANCE_CAST ((obj), DEJA_DUP_TYPE_CONFIG_WIDGET, DejaDupConfigWidget))
#define DEJA_DUP_CONFIG_WIDGET_CLASS(klass) (G_TYPE_CHECK_CLASS_CAST ((klass), DEJA_DUP_TYPE_CONFIG_WIDGET, DejaDupConfigWidgetClass))
#define DEJA_DUP_IS_CONFIG_WIDGET(obj) (G_TYPE_CHECK_INSTANCE_TYPE ((obj), DEJA_DUP_TYPE_CONFIG_WIDGET))
#define DEJA_DUP_IS_CONFIG_WIDGET_CLASS(klass) (G_TYPE_CHECK_CLASS_TYPE ((klass), DEJA_DUP_TYPE_CONFIG_WIDGET))
#define DEJA_DUP_CONFIG_WIDGET_GET_CLASS(obj) (G_TYPE_INSTANCE_GET_CLASS ((obj), DEJA_DUP_TYPE_CONFIG_WIDGET, DejaDupConfigWidgetClass))

typedef struct _DejaDupConfigWidget DejaDupConfigWidget;
typedef struct _DejaDupConfigWidgetClass DejaDupConfigWidgetClass;
typedef struct _DejaDupConfigWidgetPrivate DejaDupConfigWidgetPrivate;

#define DEJA_DUP_TYPE_CONFIG_APP_LIST (deja_dup_config_app_list_get_type ())
#define DEJA_DUP_CONFIG_APP_LIST(obj) (G_TYPE_CHECK_INSTANCE_CAST ((obj), DEJA_DUP_TYPE_CONFIG_APP_LIST, DejaDupConfigAppList))
#define DEJA_DUP_CONFIG_APP_LIST_CLASS(klass) (G_TYPE_CHECK_CLASS_CAST ((klass), DEJA_DUP_TYPE_CONFIG_APP_LIST, DejaDupConfigAppListClass))
#define DEJA_DUP_IS_CONFIG_APP_LIST(obj) (G_TYPE_CHECK_INSTANCE_TYPE ((obj), DEJA_DUP_TYPE_CONFIG_APP_LIST))
#define DEJA_DUP_IS_CONFIG_APP_LIST_CLASS(klass) (G_TYPE_CHECK_CLASS_TYPE ((klass), DEJA_DUP_TYPE_CONFIG_APP_LIST))
#define DEJA_DUP_CONFIG_APP_LIST_GET_CLASS(obj) (G_TYPE_INSTANCE_GET_CLASS ((obj), DEJA_DUP_TYPE_CONFIG_APP_LIST, DejaDupConfigAppListClass))

typedef struct _DejaDupConfigAppList DejaDupConfigAppList;
typedef struct _DejaDupConfigAppListClass DejaDupConfigAppListClass;
typedef struct _DejaDupConfigAppListPrivate DejaDupConfigAppListPrivate;
#define _g_object_unref0(var) ((var == NULL) ? NULL : (var = (g_object_unref (var), NULL)))
typedef struct _DejaDupConfigAppListSetFromConfigData DejaDupConfigAppListSetFromConfigData;
#define _g_free0(var) (var = (g_free (var), NULL))

#define DEJA_DUP_TYPE_CONFIG_APP (deja_dup_config_app_get_type ())
#define DEJA_DUP_CONFIG_APP(obj) (G_TYPE_CHECK_INSTANCE_CAST ((obj), DEJA_DUP_TYPE_CONFIG_APP, DejaDupConfigApp))
#define DEJA_DUP_CONFIG_APP_CLASS(klass) (G_TYPE_CHECK_CLASS_CAST ((klass), DEJA_DUP_TYPE_CONFIG_APP, DejaDupConfigAppClass))
#define DEJA_DUP_IS_CONFIG_APP(obj) (G_TYPE_CHECK_INSTANCE_TYPE ((obj), DEJA_DUP_TYPE_CONFIG_APP))
#define DEJA_DUP_IS_CONFIG_APP_CLASS(klass) (G_TYPE_CHECK_CLASS_TYPE ((klass), DEJA_DUP_TYPE_CONFIG_APP))
#define DEJA_DUP_CONFIG_APP_GET_CLASS(obj) (G_TYPE_INSTANCE_GET_CLASS ((obj), DEJA_DUP_TYPE_CONFIG_APP, DejaDupConfigAppClass))

typedef struct _DejaDupConfigApp DejaDupConfigApp;
typedef struct _DejaDupConfigAppClass DejaDupConfigAppClass;

#define DEJA_DUP_TYPE_CONFIG_APP_PHOTO (deja_dup_config_app_photo_get_type ())
#define DEJA_DUP_CONFIG_APP_PHOTO(obj) (G_TYPE_CHECK_INSTANCE_CAST ((obj), DEJA_DUP_TYPE_CONFIG_APP_PHOTO, DejaDupConfigAppPhoto))
#define DEJA_DUP_CONFIG_APP_PHOTO_CLASS(klass) (G_TYPE_CHECK_CLASS_CAST ((klass), DEJA_DUP_TYPE_CONFIG_APP_PHOTO, DejaDupConfigAppPhotoClass))
#define DEJA_DUP_IS_CONFIG_APP_PHOTO(obj) (G_TYPE_CHECK_INSTANCE_TYPE ((obj), DEJA_DUP_TYPE_CONFIG_APP_PHOTO))
#define DEJA_DUP_IS_CONFIG_APP_PHOTO_CLASS(klass) (G_TYPE_CHECK_CLASS_TYPE ((klass), DEJA_DUP_TYPE_CONFIG_APP_PHOTO))
#define DEJA_DUP_CONFIG_APP_PHOTO_GET_CLASS(obj) (G_TYPE_INSTANCE_GET_CLASS ((obj), DEJA_DUP_TYPE_CONFIG_APP_PHOTO, DejaDupConfigAppPhotoClass))

typedef struct _DejaDupConfigAppPhoto DejaDupConfigAppPhoto;
typedef struct _DejaDupConfigAppPhotoClass DejaDupConfigAppPhotoClass;

#define DEJA_DUP_TYPE_CONFIG_APP_DOC (deja_dup_config_app_doc_get_type ())
#define DEJA_DUP_CONFIG_APP_DOC(obj) (G_TYPE_CHECK_INSTANCE_CAST ((obj), DEJA_DUP_TYPE_CONFIG_APP_DOC, DejaDupConfigAppDoc))
#define DEJA_DUP_CONFIG_APP_DOC_CLASS(klass) (G_TYPE_CHECK_CLASS_CAST ((klass), DEJA_DUP_TYPE_CONFIG_APP_DOC, DejaDupConfigAppDocClass))
#define DEJA_DUP_IS_CONFIG_APP_DOC(obj) (G_TYPE_CHECK_INSTANCE_TYPE ((obj), DEJA_DUP_TYPE_CONFIG_APP_DOC))
#define DEJA_DUP_IS_CONFIG_APP_DOC_CLASS(klass) (G_TYPE_CHECK_CLASS_TYPE ((klass), DEJA_DUP_TYPE_CONFIG_APP_DOC))
#define DEJA_DUP_CONFIG_APP_DOC_GET_CLASS(obj) (G_TYPE_INSTANCE_GET_CLASS ((obj), DEJA_DUP_TYPE_CONFIG_APP_DOC, DejaDupConfigAppDocClass))

typedef struct _DejaDupConfigAppDoc DejaDupConfigAppDoc;
typedef struct _DejaDupConfigAppDocClass DejaDupConfigAppDocClass;

struct _DejaDupConfigWidget {
	GtkEventBox parent_instance;
	DejaDupConfigWidgetPrivate * priv;
	gboolean syncing;
	DejaDupSimpleSettings* settings;
	GList* all_settings;
};

struct _DejaDupConfigWidgetClass {
	GtkEventBoxClass parent_class;
	void (*set_from_config) (DejaDupConfigWidget* self, GAsyncReadyCallback _callback_, gpointer _user_data_);
	void (*set_from_config_finish) (DejaDupConfigWidget* self, GAsyncResult* _res_);
};

struct _DejaDupConfigAppList {
	DejaDupConfigWidget parent_instance;
	DejaDupConfigAppListPrivate * priv;
};

struct _DejaDupConfigAppListClass {
	DejaDupConfigWidgetClass parent_class;
};

struct _DejaDupConfigAppListSetFromConfigData {
	int _state_;
	GObject* _source_object_;
	GAsyncResult* _res_;
	GSimpleAsyncResult* _async_result;
	DejaDupConfigAppList* self;
};


static gpointer deja_dup_config_app_list_parent_class = NULL;

GType deja_dup_config_widget_get_type (void) G_GNUC_CONST;
GType deja_dup_config_app_list_get_type (void) G_GNUC_CONST;
enum  {
	DEJA_DUP_CONFIG_APP_LIST_DUMMY_PROPERTY
};
DejaDupConfigAppList* deja_dup_config_app_list_new (void);
DejaDupConfigAppList* deja_dup_config_app_list_construct (GType object_type);
DejaDupConfigWidget* deja_dup_config_widget_construct (GType object_type);
static void deja_dup_config_app_list_real_set_from_config_data_free (gpointer _data);
static void deja_dup_config_app_list_real_set_from_config (DejaDupConfigWidget* base, GAsyncReadyCallback _callback_, gpointer _user_data_);
static gboolean deja_dup_config_app_list_real_set_from_config_co (DejaDupConfigAppListSetFromConfigData* _data_);
static GObject * deja_dup_config_app_list_constructor (GType type, guint n_construct_properties, GObjectConstructParam * construct_properties);
DejaDupConfigApp* deja_dup_config_app_new (const gchar* key);
DejaDupConfigApp* deja_dup_config_app_construct (GType object_type, const gchar* key);
GType deja_dup_config_app_get_type (void) G_GNUC_CONST;
DejaDupConfigAppPhoto* deja_dup_config_app_photo_new (void);
DejaDupConfigAppPhoto* deja_dup_config_app_photo_construct (GType object_type);
GType deja_dup_config_app_photo_get_type (void) G_GNUC_CONST;
DejaDupConfigAppDoc* deja_dup_config_app_doc_new (void);
DejaDupConfigAppDoc* deja_dup_config_app_doc_construct (GType object_type);
GType deja_dup_config_app_doc_get_type (void) G_GNUC_CONST;
void deja_dup_config_widget_set_from_config (DejaDupConfigWidget* self, GAsyncReadyCallback _callback_, gpointer _user_data_);
void deja_dup_config_widget_set_from_config_finish (DejaDupConfigWidget* self, GAsyncResult* _res_);
static void _vala_array_destroy (gpointer array, gint array_length, GDestroyNotify destroy_func);
static void _vala_array_free (gpointer array, gint array_length, GDestroyNotify destroy_func);
static gint _vala_array_length (gpointer array);


DejaDupConfigAppList* deja_dup_config_app_list_construct (GType object_type) {
	DejaDupConfigAppList * self = NULL;
	self = (DejaDupConfigAppList*) deja_dup_config_widget_construct (object_type);
	return self;
}


DejaDupConfigAppList* deja_dup_config_app_list_new (void) {
	return deja_dup_config_app_list_construct (DEJA_DUP_TYPE_CONFIG_APP_LIST);
}


static void deja_dup_config_app_list_real_set_from_config_data_free (gpointer _data) {
	DejaDupConfigAppListSetFromConfigData* _data_;
	_data_ = _data;
	_g_object_unref0 (_data_->self);
	g_slice_free (DejaDupConfigAppListSetFromConfigData, _data_);
}


static gpointer _g_object_ref0 (gpointer self) {
	return self ? g_object_ref (self) : NULL;
}


static void deja_dup_config_app_list_real_set_from_config (DejaDupConfigWidget* base, GAsyncReadyCallback _callback_, gpointer _user_data_) {
	DejaDupConfigAppList * self;
	DejaDupConfigAppListSetFromConfigData* _data_;
	DejaDupConfigAppList* _tmp0_;
	self = (DejaDupConfigAppList*) base;
	_data_ = g_slice_new0 (DejaDupConfigAppListSetFromConfigData);
	_data_->_async_result = g_simple_async_result_new (G_OBJECT (self), _callback_, _user_data_, deja_dup_config_app_list_real_set_from_config);
	g_simple_async_result_set_op_res_gpointer (_data_->_async_result, _data_, deja_dup_config_app_list_real_set_from_config_data_free);
	_tmp0_ = _g_object_ref0 (self);
	_data_->self = _tmp0_;
	deja_dup_config_app_list_real_set_from_config_co (_data_);
}


static void deja_dup_config_app_list_real_set_from_config_finish (DejaDupConfigWidget* base, GAsyncResult* _res_) {
	DejaDupConfigAppListSetFromConfigData* _data_;
	_data_ = g_simple_async_result_get_op_res_gpointer (G_SIMPLE_ASYNC_RESULT (_res_));
}


static gboolean deja_dup_config_app_list_real_set_from_config_co (DejaDupConfigAppListSetFromConfigData* _data_) {
	switch (_data_->_state_) {
		case 0:
		goto _state_0;
		default:
		g_assert_not_reached ();
	}
	_state_0:
	if (_data_->_state_ == 0) {
		g_simple_async_result_complete_in_idle (_data_->_async_result);
	} else {
		g_simple_async_result_complete (_data_->_async_result);
	}
	g_object_unref (_data_->_async_result);
	return FALSE;
}


static GObject * deja_dup_config_app_list_constructor (GType type, guint n_construct_properties, GObjectConstructParam * construct_properties) {
	GObject * obj;
	GObjectClass * parent_class;
	DejaDupConfigAppList * self;
	GtkScrolledWindow* _tmp0_;
	GtkScrolledWindow* _tmp1_;
	GtkScrolledWindow* scroll;
	GtkScrolledWindow* _tmp2_;
	GtkScrolledWindow* _tmp3_;
	GtkScrolledWindow* _tmp4_;
	GtkScrolledWindow* _tmp5_;
	GtkViewport* _tmp6_;
	GtkViewport* _tmp7_;
	GtkViewport* viewport;
	GtkScrolledWindow* _tmp8_;
	GtkViewport* _tmp9_;
	GtkVBox* _tmp10_;
	GtkVBox* _tmp11_;
	GtkVBox* box;
	GtkViewport* _tmp12_;
	GtkVBox* _tmp13_;
	DejaDupSimpleSettings* _tmp14_ = NULL;
	DejaDupSimpleSettings* _tmp15_;
	gchar** _tmp16_;
	gchar** _tmp17_ = NULL;
	DejaDupConfigAppPhoto* _tmp31_;
	DejaDupConfigAppPhoto* _tmp32_;
	DejaDupConfigAppPhoto* appphoto;
	GtkVBox* _tmp33_;
	DejaDupConfigAppPhoto* _tmp34_;
	DejaDupConfigAppDoc* _tmp35_;
	DejaDupConfigAppDoc* _tmp36_;
	DejaDupConfigAppDoc* appdoc;
	GtkVBox* _tmp37_;
	DejaDupConfigAppDoc* _tmp38_;
	parent_class = G_OBJECT_CLASS (deja_dup_config_app_list_parent_class);
	obj = parent_class->constructor (type, n_construct_properties, construct_properties);
	self = DEJA_DUP_CONFIG_APP_LIST (obj);
	_tmp0_ = (GtkScrolledWindow*) gtk_scrolled_window_new (NULL, NULL);
	_tmp1_ = g_object_ref_sink (_tmp0_);
	scroll = _tmp1_;
	_tmp2_ = scroll;
	g_object_set (_tmp2_, "hscrollbar-policy", GTK_POLICY_AUTOMATIC, NULL);
	_tmp3_ = scroll;
	g_object_set (_tmp3_, "vscrollbar-policy", GTK_POLICY_AUTOMATIC, NULL);
	_tmp4_ = scroll;
	gtk_scrolled_window_set_shadow_type (_tmp4_, GTK_SHADOW_IN);
	_tmp5_ = scroll;
	gtk_container_add ((GtkContainer*) self, (GtkWidget*) _tmp5_);
	_tmp6_ = (GtkViewport*) gtk_viewport_new (NULL, NULL);
	_tmp7_ = g_object_ref_sink (_tmp6_);
	viewport = _tmp7_;
	_tmp8_ = scroll;
	_tmp9_ = viewport;
	gtk_container_add ((GtkContainer*) _tmp8_, (GtkWidget*) _tmp9_);
	_tmp10_ = (GtkVBox*) gtk_vbox_new (FALSE, 0);
	_tmp11_ = g_object_ref_sink (_tmp10_);
	box = _tmp11_;
	_tmp12_ = viewport;
	_tmp13_ = box;
	gtk_container_add ((GtkContainer*) _tmp12_, (GtkWidget*) _tmp13_);
	_tmp14_ = deja_dup_get_settings (DEJA_DUP_APPS_ROOT);
	_g_object_unref0 (((DejaDupConfigWidget*) self)->settings);
	((DejaDupConfigWidget*) self)->settings = _tmp14_;
	_tmp15_ = ((DejaDupConfigWidget*) self)->settings;
	_tmp17_ = _tmp16_ = g_settings_list_children ((GSettings*) _tmp15_);
	{
		gchar** name_collection = NULL;
		gint name_collection_length1 = 0;
		gint _name_collection_size_ = 0;
		gint name_it = 0;
		name_collection = _tmp17_;
		name_collection_length1 = _vala_array_length (_tmp16_);
		for (name_it = 0; name_it < _vala_array_length (_tmp16_); name_it = name_it + 1) {
			gchar* _tmp18_;
			gchar* name = NULL;
			_tmp18_ = g_strdup (name_collection[name_it]);
			name = _tmp18_;
			{
				const gchar* _tmp19_;
				gchar* _tmp20_;
				gchar* _tmp21_;
				GFile* _tmp22_ = NULL;
				GFile* _tmp23_;
				GFile* file;
				GFile* _tmp24_;
				gboolean _tmp25_ = FALSE;
				const gchar* _tmp26_;
				DejaDupConfigApp* _tmp27_;
				DejaDupConfigApp* _tmp28_;
				DejaDupConfigApp* app;
				GtkVBox* _tmp29_;
				DejaDupConfigApp* _tmp30_;
				_tmp19_ = name;
				_tmp20_ = g_strconcat ("/usr/bin/", _tmp19_, NULL);
				_tmp21_ = _tmp20_;
				_tmp22_ = g_file_new_for_path (_tmp21_);
				_tmp23_ = _tmp22_;
				_g_free0 (_tmp21_);
				file = _tmp23_;
				_tmp24_ = file;
				_tmp25_ = g_file_query_exists (_tmp24_, NULL);
				if (!_tmp25_) {
					_g_object_unref0 (file);
					_g_free0 (name);
					continue;
				}
				_tmp26_ = name;
				_tmp27_ = deja_dup_config_app_new (_tmp26_);
				_tmp28_ = g_object_ref_sink (_tmp27_);
				app = _tmp28_;
				_tmp29_ = box;
				_tmp30_ = app;
				gtk_box_pack_start ((GtkBox*) _tmp29_, (GtkWidget*) _tmp30_, FALSE, FALSE, (guint) 0);
				_g_object_unref0 (app);
				_g_object_unref0 (file);
				_g_free0 (name);
			}
		}
		name_collection = (_vala_array_free (name_collection, name_collection_length1, (GDestroyNotify) g_free), NULL);
	}
	_tmp31_ = deja_dup_config_app_photo_new ();
	_tmp32_ = g_object_ref_sink (_tmp31_);
	appphoto = _tmp32_;
	_tmp33_ = box;
	_tmp34_ = appphoto;
	gtk_box_pack_start ((GtkBox*) _tmp33_, (GtkWidget*) _tmp34_, FALSE, FALSE, (guint) 0);
	_tmp35_ = deja_dup_config_app_doc_new ();
	_tmp36_ = g_object_ref_sink (_tmp35_);
	appdoc = _tmp36_;
	_tmp37_ = box;
	_tmp38_ = appdoc;
	gtk_box_pack_start ((GtkBox*) _tmp37_, (GtkWidget*) _tmp38_, FALSE, FALSE, (guint) 0);
	deja_dup_config_widget_set_from_config ((DejaDupConfigWidget*) self, NULL, NULL);
	_g_object_unref0 (appdoc);
	_g_object_unref0 (appphoto);
	_g_object_unref0 (box);
	_g_object_unref0 (viewport);
	_g_object_unref0 (scroll);
	return obj;
}


static void deja_dup_config_app_list_class_init (DejaDupConfigAppListClass * klass) {
	deja_dup_config_app_list_parent_class = g_type_class_peek_parent (klass);
	DEJA_DUP_CONFIG_WIDGET_CLASS (klass)->set_from_config = deja_dup_config_app_list_real_set_from_config;
	DEJA_DUP_CONFIG_WIDGET_CLASS (klass)->set_from_config_finish = deja_dup_config_app_list_real_set_from_config_finish;
	G_OBJECT_CLASS (klass)->constructor = deja_dup_config_app_list_constructor;
}


static void deja_dup_config_app_list_instance_init (DejaDupConfigAppList * self) {
}


GType deja_dup_config_app_list_get_type (void) {
	static volatile gsize deja_dup_config_app_list_type_id__volatile = 0;
	if (g_once_init_enter (&deja_dup_config_app_list_type_id__volatile)) {
		static const GTypeInfo g_define_type_info = { sizeof (DejaDupConfigAppListClass), (GBaseInitFunc) NULL, (GBaseFinalizeFunc) NULL, (GClassInitFunc) deja_dup_config_app_list_class_init, (GClassFinalizeFunc) NULL, NULL, sizeof (DejaDupConfigAppList), 0, (GInstanceInitFunc) deja_dup_config_app_list_instance_init, NULL };
		GType deja_dup_config_app_list_type_id;
		deja_dup_config_app_list_type_id = g_type_register_static (DEJA_DUP_TYPE_CONFIG_WIDGET, "DejaDupConfigAppList", &g_define_type_info, 0);
		g_once_init_leave (&deja_dup_config_app_list_type_id__volatile, deja_dup_config_app_list_type_id);
	}
	return deja_dup_config_app_list_type_id__volatile;
}


static void _vala_array_destroy (gpointer array, gint array_length, GDestroyNotify destroy_func) {
	if ((array != NULL) && (destroy_func != NULL)) {
		int i;
		for (i = 0; i < array_length; i = i + 1) {
			if (((gpointer*) array)[i] != NULL) {
				destroy_func (((gpointer*) array)[i]);
			}
		}
	}
}


static void _vala_array_free (gpointer array, gint array_length, GDestroyNotify destroy_func) {
	_vala_array_destroy (array, array_length, destroy_func);
	g_free (array);
}


static gint _vala_array_length (gpointer array) {
	int length;
	length = 0;
	if (array) {
		while (((gpointer*) array)[length]) {
			length++;
		}
	}
	return length;
}



